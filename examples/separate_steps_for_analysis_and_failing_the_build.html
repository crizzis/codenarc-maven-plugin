<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src\site\markdown/examples\separate_steps_for_analysis_and_failing_the_build.md at 2020-05-22
 | Rendered using Apache Maven Fluido Skin 1.9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>CodeNarc Maven Plugin &#x2013; Separate Steps for Analysis and Failing the Build</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.9.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-1.9.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/crizzis/codenarc-maven-plugin">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h2>CodeNarc Maven Plugin</h2>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2020-05-22<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 0.1-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="../index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="../plugin-info.html" title="Goals"><span class="none"></span>Goals</a></li>
    <li><a href="../usage.html" title="Usage"><span class="none"></span>Usage</a></li>
    <li><a href="../sample/codenarc.html" title="Sample Generated Report"><span class="none"></span>Sample Generated Report</a></li>
    <li><a href="../faq.html" title="FAQ"><span class="none"></span>FAQ</a></li>
   <li class="nav-header">Examples</li>
    <li><a href="../examples/custom_rule_sets.html" title="Custom Rule Sets"><span class="none"></span>Custom Rule Sets</a></li>
    <li><a href="../examples/including_excluding_files.html" title="Including/Excluding Files"><span class="none"></span>Including/Excluding Files</a></li>
    <li><a href="../examples/custom_source_roots.html" title="Custom Source Roots"><span class="none"></span>Custom Source Roots</a></li>
    <li class="active"><a href="#"><span class="none"></span>Separate Steps for Analysis and Failing the Build</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<section>
<h2><a name="Separate_Steps_for_Analysis_and_Failing_the_Build"></a>Separate Steps for Analysis and Failing the Build</h2>
<p>The typical use of the <code>codenarc:verify</code> goal is to perform CodeNarc analysis (producing a CodeNarc XML report) and fail the build if it does not meet the configured quality criteria. All of this happens within a single execution of the goal.</p>
<p>For certain customized build, though, it might make sense to perform the analysis in one build phase, and then act upon the result in another. An example scenario for such a build is when you need to <i>both</i> generate the HTML report <i>and</i> fail a build with substandard code quality (if <i>codenarc:codenarc</i> is configured to fail the build under certain conditions - either as a standalone goal or as part of reporting - then a failing build will prevent the HTML report from being generated).</p>
<p>In order to achieve such a goal, the <code>&lt;ignoreExistingReport&gt;</code> flag can be used. By default, the flag is set to <code>true</code>, meaning that <code>codenarc:verify</code> will always perform a CodeNarc analysis from scratch. Setting the flag to <code>false</code> will cause <code>codenarc:verify</code> to use previously generated <code>CodeNarc.xml</code>, if exists.</p>
<p>For example, to perform CodeNarc analysis during the <code>process-resources</code> phase but not fail the build just yet, you can use the following configuration:</p>

<div>
<div>
<pre class="source">&lt;build&gt;
    &lt;plugins&gt;
        ...
        &lt;plugin&gt;
            &lt;groupId&gt;io.github.crizzis&lt;/groupId&gt;
            &lt;artifactId&gt;codenarc-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;0.1&lt;/version&gt;
            &lt;executions&gt;
                &lt;execution&gt;
                    &lt;id&gt;perform-codenarc-analysis&lt;/id&gt;
                    &lt;phase&gt;process-resources&lt;/phase&gt;
                    &lt;goals&gt;
                        &lt;goal&gt;verify&lt;/goal&gt;
                    &lt;/goals&gt;
                &lt;/execution&gt;
            &lt;/executions&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;
</pre></div></div>

<p>You can then define another execution of the <code>codenarc:verify</code> goal to consume the report generated in the previous execution (and fail the build if the specified criteria are not met), in another lifecycle phase (e.g. <code>verify</code>)</p>

<div>
<div>
<pre class="source">&lt;execution&gt;
    &lt;id&gt;analyze-results&lt;/id&gt;
    &lt;phase&gt;verify&lt;/phase&gt;
    &lt;goals&gt;
        &lt;goal&gt;verify&lt;/goal&gt;
    &lt;/goals&gt;
    &lt;configuration&gt;
        &lt;ignoreExistingReport&gt;false&lt;/ignoreExistingReport&gt;
        &lt;maxPriority1Violations&gt;2&lt;/maxPriority1Violations&gt;
        &lt;maxPriority2Violations&gt;3&lt;/maxPriority2Violations&gt;
        &lt;maxPriority3Violations&gt;1&lt;/maxPriority3Violations&gt;
    &lt;/configuration&gt;
&lt;/execution&gt;
</pre></div></div>

<p><b>Warning</b>: this is an advanced use case scenario. Please take special care when using the above approach and make sure you understand the implications it may have on your build. In particular, failing to execute the <code>clean</code> goal may, in some instances, result in stale analysis results getting consumed by the <i>codenarc:verify</i> goal.</p></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2020
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
